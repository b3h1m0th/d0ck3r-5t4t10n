#! /bin/bash

BIN=/usr/bin/chromium-browser

# Cleanup
if ! pgrep chromium > /dev/null;then
  rm -f $HOME/.config/chromium/Singleton*
fi

# Disable GPU without Nvidia
if which nvidia-smi; then
  DISABLE_GPU=""
else
  DISABLE_GPU="--disable-gpu"
fi

# Run normally on privved containers or modified un non priv
if grep -q 'Seccomp:.0' /proc/1/status; then
  ${BIN} --password-store=basic ${DISABLE_GPU} "$@"
else
  ${BIN} --password-store=basic ${DISABLE_GPU} --no-sandbox --test-type "$@"
fi
